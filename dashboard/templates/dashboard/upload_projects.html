{% extends "base.html" %}
{% load admin_urls %}
{% load dima_utils %}

{% block 'head-title' %}Proyectos - {% endblock %}

{% block 'main' %}

<div class="container-lg">
  <div class="row">

    <h1 class="display-3">Proyectos</h1>




      <form method="post" class="dima-dragndrop_form" enctype="multipart/form-data" action="{% url 'upload_project' %}">
        {% csrf_token %}
        <!--<input type="file" name="xmlfile" />-->
        <!--<input type="submit" name="submit" value="Upload" />-->

          <div class="dima-dragndrop">
            <!--<input type="file" name="xmlfile" id="file" class="dima-dragndrop_input" multiple />-->

            <div class="mb-3">
              <input class="form-control dima-dragndrop_input" name="xmlfile" type="file" id="file" multiple>
            </div>

            <div class="dima-dragndrop_area" for="dima-dragndrop_form">
              <strong>Seleccionar archivos</strong><span> o arrastrarlos aqu√≠</span>.<br><br>
            </div>
          </div>

      </form>

      <table class="table table-hover">

        <thead>
          <tr>
            <th scope="col">Proyecto</th>
            <th scope="col">Director</th>
            <th scope="col">Facultad</th>
            <th scope="col">Departamento</th>
            <th scope="col">Tipologia</th>        
            <th scope="col">Convocatoria</th>
            <th scope="col">Estado</th>
          </tr>
        </thead>
    
        <tbody>
        {% for project in projects %}
    
          {% replace project.project_name '' '' as name %}
          {% replace project.first_name '' '' as first_name %}
          {% replace project.last_name '' '' as last_name %}
          {% replace project.call_type_pretty '' '' as call_type %}
          {% replace project.faculty_pretty '' '' as faculty %}
          {% replace project.departament_pretty '' '' as department %}
          {% replace project.call '' '' as call %}
          {% replace project.project_state_pretty '' '' as state %}
          <tr>
            <td class="dima-group--view" data-obscure="{{project.obscure}}">
              <a class="btn btn-link dima--table-btn-link" href="{% url 'projects' project.obscure %}" role="button" target="_blank">{{name}}</a>
              {% if user.is_authenticated %}
                <a class="" href="{% url projects_admin|admin_urlname:'change' project.obscure %}">Editar<i class="bi bi-pencil-square"></i></a>
                <a class="" href="{% url 'projects' project.obscure %}/report" target="_blank"> Reporte<i class="bi bi-pencil-square"></i></a>
              {% endif %}
            </td>
            <td style="text-align:center;vertical-align:top;"> {{first_name|title}} {{last_name|title}}</td>
            <td style="text-align:center;vertical-align:top;">{{faculty|title}}</td>
            <td style="text-align:center;vertical-align:top;">{{department|title}}</td>
            
            <td style="text-align:center;vertical-align:top;">{{call_type|title}}</td>
            
            <td style="text-align:center;vertical-align:top;">{{call|title}}</td>
    
            <td style="text-align:center;vertical-align:top;">{{state|title}}</td>
          </tr>
        {% endfor %}
        </tbody>
    
      </table>




  </div>
</div>
{% endblock %}

